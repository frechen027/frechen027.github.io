# 函数

函数是组织好的、可重复使用的代码段，用于实现单一的功能。

## 1. 定义与调用

使用 `def` 关键字定义函数。

```python
def say_hello():
    """这是一个简单的问候函数"""
    print("Hello, Python!")

# 调用函数
say_hello()
```

## 2. 参数传递

### 位置参数 (Positional Arguments)

按顺序传递参数。

```python
def sub(a, b):
    return a - b

print(sub(10, 3))  # 7
print(sub(3, 10))  # -7
```

### 关键字参数 (Keyword Arguments)

通过参数名指定，顺序不重要。

```python
print(sub(b=3, a=10))  # 7
```

### 默认参数 (Default Arguments)

为参数提供默认值。**注意：默认参数必须放在非默认参数之后。**

```python
def greet(name, msg="Good morning"):
    print(f"{msg}, {name}")

greet("Alice")                  # 使用默认 msg
greet("Bob", "Good evening")    # 覆盖默认 msg
```

!!! warning "可变默认参数陷阱"
**千万不要**使用可变对象（如列表、字典）作为默认参数值！

```python
# ❌ 错误做法
def append_to(num, target=[]):
    target.append(num)
    return target

print(append_to(1)) # [1]
print(append_to(2)) # [1, 2] -> 竟然记住了上次的状态！

# ✅ 正确做法
def append_to(num, target=None):
    if target is None:
        target = []
    target.append(num)
    return target
```

## 3. 返回值 (return)

-   使用 `return` 返回结果。
-   如果没有 `return`，默认返回 `None`。
-   可以返回多个值（本质是返回一个元组）。

```python
def get_user_info():
    name = "Alice"
    age = 25
    return name, age  # 返回元组 ("Alice", 25)

n, a = get_user_info() # 解包
```

## 4. 可变长参数

用于处理不确定数量的参数。

-   `*args`: 接收任意数量的位置参数（打包成**元组**）。
-   `**kwargs`: 接收任意数量的关键字参数（打包成**字典**）。

```python
def func(required, *args, **kwargs):
    print(f"Required: {required}")
    print(f"Args (tuple): {args}")
    print(f"Kwargs (dict): {kwargs}")

func(1, 2, 3, 4, name="Alice", val=True)
# Output:
# Required: 1
# Args (tuple): (2, 3, 4)
# Kwargs (dict): {'name': 'Alice', 'val': True}
```

## 5. 作用域 (Scope)

-   **Local (局部)**: 函数内部定义的变量。
-   **Global (全局)**: 模块级别定义的变量。

在函数内部修改全局变量需要使用 `global` 关键字（不推荐）。

```python
count = 0  # 全局变量

def increment():
    global count
    count += 1

increment()
print(count) # 1
```

## 6. Lambda 函数 (匿名函数)

用于定义简单的、一行的函数。

```python
# 语法: lambda arguments: expression
square = lambda x: x * x

print(square(5))  # 25

# 常见用途：作为参数传给 sort, map, filter
data = [(1, 'd'), (2, 'b'), (4, 'a'), (3, 'c')]
# 按第二个元素排序
data.sort(key=lambda x: x[1])
print(data) # Sort by letter
```

## 7. 类型提示 (Type Hints)

Python 3.5+ 引入，虽然不强制，但强烈建议写上。

```python
def calculate_area(width: float, height: float) -> float:
    return width * height
```

## 本章小结

| 概念       | 说明                           |
| ---------- | ------------------------------ |
| `def`      | 定义函数                       |
| `return`   | 返回值，可返回多个             |
| 参数       | 位置参数、关键字参数、默认参数 |
| `*args`    | 可变位置参数 (Tuple)           |
| `**kwargs` | 可变关键字参数 (Dict)          |
| `lambda`   | 匿名函数，短小精悍             |

## 练习题

1. **基本函数**：编写 `max_of_three(a, b, c)` 函数，返回三个数中的最大值。
2. **默认参数**：编写 `power(x, n=2)` 函数，计算 x 的 n 次方，默认计算平方。
3. **可变参数**：编写 `sum_all(*args)` 函数，计算所有传入数字的总和。

---

_下一章：[文件操作](07_文件操作.md)_
